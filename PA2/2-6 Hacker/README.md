# CST2021F 2-6 Hacker

------

### **描述**

　　黑客小Y读取到了某网站的数据库，并开始破解用户密码。

　　对于密码明文字符串 M，数据库内保存的是 hash(M)=CRC32(M+salt)，其中 CRC32 是将任意长度的字符串转成 32 位整数的函数，salt 是一个字符串（我们称其为“盐”），+ 表示字符串的拼接。该网站规定，密码和盐的每一个字符必须是`0123456789tsinghua`这 18 个字符之一。由于设计失误，该网站给每个用户用了相同的盐。

　　小Y的任务是，对于数据库每条记录里的密码哈希值 hash(M)，尽量求逆破解其明文 M。

　　因为一个哈希值的求逆结果有无穷多个，所以我们对答案给出一些限制。在第 i 次求逆的时候（i 从1 开始编号），我们只考虑 M 在明文集合 Di 里的情况。如果能在集合 Di 中找到唯一的明文，输出这个明文；如果集合里没有匹配的明文，输出`No`；如果集合里有多个匹配的明文，输出`Duplicate`。

　　其中，Di 的定义为：

- D1={1 ~ 5 位密码明文}, 也就是由`0123456789tsinghua`中的字符组成且长度 1 ~ 5 的所有字符串，如`2333`、`shang`、`hai`。
- Di+1=Di∪Ai，其中集合 Ai 是“前 i 条密文中，最后 k(k≤8) 条成功破解的明文的首字母顺次连接构成的字符串”。

　　假如从第 1 次开始的 11 个破解结果是 `1`、`22`、`333`、`4444`、`No`、`Duplicate`、`t`、`ss`、`iii`、`nnnn`、`ggggg`，那么：

　　　　A1={`1`}

　　　　A2={`2`,`12`}

　　　　A3={`3`, `23`, `123`}

　　　　A4={`4`, `34`, `234`, `1234`}

　　　　A5={`4`, `34`, `234`, `1234`}

　　　　A6={`4`, `34`, `234`, `1234`}

　　　　A7={`t`, `4t`, `34t`, `234t`, `1234t`}

　　　　A8={`s`, `ts`, `4ts`, `34ts`, `234ts`, `1234ts`}

　　　　A9={`i`, `si`, `tsi`, `4tsi`, `34tsi`, `234tsi`, `1234tsi`}

　　　　A10={`n`, `in`, `sin`, `tsin`, `4tsin`, `34tsin`, `234tsin`, `1234tsin`}

　　　　A11={`g`, `ng`, `ing`, `sing`, `tsing`, `4tsing`, `34tsing`, `234tsing`}

　　我们提供了 CRC32 的计算文件 [crc32.zip](https://dsa.cs.tsinghua.edu.cn/oj/attachment/112e/112e8204d99817ef68123c74458ca7e649eea106.zip)，通过 `#include "crc32.h"` 引用，调用 `crc32(0, buf, len)` 计算 `buf` 的 CRC32 值。你也可以不使用我们提供的 `crc32` 函数，使用与否不影响评分。OJ 评测时，请不要提交该压缩包中的文件，我们会在评测时为你自动加入该文件，重复提交可能导致函数重定义的编译错误。

### **输入**

　　第 1 行为 n。

　　第 2 行为盐。

　　接下来 n 行，每行是一个 CRC32 值，是字符串长度为 8 的小写十六进制数，为小 Y 窃听到的一个密文。

### **输出**

　　共 n 行，每行对应一条密文的破解结果。

### **输入样例**

```
11
thu
094dca7d
46730bd8
00000000
a3162b22
75426c9c
594da650
cbb32701
d74db8e2
094dca7d
dcb0ffb7
9a4ab472
```

　　*此样例是第 1 个测试点。

### **输出样例**

```
4thin
666
No
u
uu
uuu
uuuu
uuuuu
Duplicate
12345
6uuuuu1
```

　　样例解释：第二次破解 `0x094dca7d` 时，CRC32(`4thin`+salt)=CRC32(`6uuuuu`+salt)= `0x094dca7d`，故结果为 `Duplicate`。

### **数据范围**

　　1≤n≤1,000,000

　　1≤ 盐的长度 ≤4

### **资源限制**

　　时间限制：2 sec

　　空间限制：256 MB

### **提示**

- 若使用 5 层嵌套循环（如 `for`、`while` 等）处理初始的字符串集合，将被扣除 30 分的白盒分数。
- 散列
- [ CRC32 是流式函数：将 buf1 的 CRC32 值作为初始值，计算 buf2 的 CRC32 值，将得到 buf1 + buf2 的 CRC32 值，你可以利用这一性质避免较为繁琐的字符串拼接操作。 ]